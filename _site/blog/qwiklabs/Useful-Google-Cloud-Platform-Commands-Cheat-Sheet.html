<!DOCTYPE html>
<html>
  <head>
    <meta charset='UTF-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="msvalidate.01" content="9C87A2FE066C755406F5FFCAE1321439" />
    <link rel="shortcut icon" type="image/png" href="/favicon.png"/>
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.2/css/all.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="/assets/css/style.css?v=" media="screen" type="text/css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print" type="text/css">
    <link rel="stylesheet" href="/assets/css/styles.css">
    <link rel="stylesheet" href="/assets/css/header.css">
    
    

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Useful Google Cloud Platform Commands Cheat Sheet (15 Practical Tips) | Chris KY FUNG's GitHub Page</title>
    <meta name="author" content=>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
      <meta content="Useful Google Cloud Platform Commands Cheat Sheet (15 Practical Tips) | Chris KY FUNG's GitHub Page" property="og:title">
    
    
      <meta content="Feel free to bookmark this to keep an eye on my project updates" property="og:description">
    
    
      <meta content="http://localhost:4000/images/posts/write-2160925.svg" property="og:image">
    

  </head>

  <body>
    <header>
      <div class="inner">
        <a href="http://localhost:4000/">
          <h1>Chris KY FUNG's GitHub Page</h1>
        </a>
        <h2>Feel free to bookmark this to keep an eye on my project updates</h2>
        
        
      </div>
    </header>
	  
    <nav>
  <ul>
    
    <li><a href="/" >
      Home
    </a></li>
    
    <li><a href="/about.html" >
      About
    </a></li>
    
    <li><a href="/blog/index.html" >
      Blog
    </a></li>
    
    <li id="toggle-search"><i class="fas fa-search" onclick="toggleSearchBar()"></i></li>
  </ul>
</nav>
<script async src="https://cse.google.com/cse.js?cx=011006674894885990812:tjln7k0nyjx"></script>
<div class="gcse-search"></div>
<script>
  function toggleSearchBar() {
    var searchBar = document.querySelector("#___gcse_0");
    if ( searchBar.style.display == "block") {
      searchBar.style.display = "none";
    } else {
      searchBar.style.display = "block";
    }
  }
</script>
    <div id="content-wrapper">
	<div class="inner clearfix">
	<section id="main-content">
	  <h2 class="title">Useful Google Cloud Platform Commands Cheat Sheet (15 Practical Tips)</h2>

<div class="page-info">
	<span class="date"><info datetime="2019-11-06 13:12:00 +0000">
		06 Nov 2019  by Chris KY Fung 
	</info></span>
	<span class="page-tags">
		
		
		<a href="/tag/Google Cloud"><code class="highligher-rouge"><nobr>Google Cloud</nobr></code>&nbsp;</a>
		
		
		<a href="/tag/user tips"><code class="highligher-rouge"><nobr>user tips</nobr></code>&nbsp;</a>
		
		
		<a href="/tag/gcloud"><code class="highligher-rouge"><nobr>gcloud</nobr></code>&nbsp;</a>
		
		
		<a href="/tag/Terraform"><code class="highligher-rouge"><nobr>Terraform</nobr></code>&nbsp;</a>
		
		
		<a href="/tag/Qwiklabs"><code class="highligher-rouge"><nobr>Qwiklabs</nobr></code>&nbsp;</a>
		
		
		<a href="/tag/shorthand"><code class="highligher-rouge"><nobr>shorthand</nobr></code>&nbsp;</a>
		
	</span>
	<br><br>
	<!-- Go to www.addthis.com/dashboard to customize your tools -->
	<div class="addthis_inline_share_toolbox"></div>
</div>

<!-- Post content -->
<div class="notebody">
	<p><strong>gcloud</strong> is the primary CLI tool for the Google Cloud Platform. You can find a shortlist of the frequently used commands below. There are also some examples of <strong>gsutil</strong> and <strong>terraform</strong> command-line tools. Mastering them helps you to script and automate many GCP operations.</p>

<!--more-->

<h2 id="install-gcloud-command-line-tool">Install gcloud command-line tool</h2>

<p><strong>For Linux</strong></p>

<p>Visit https://cloud.google.com/sdk/docs/#linux to obtain the download link of Google Cloud SDK and download the latest package. Unzip the file, and run these commands:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./google-cloud-sdk/install.sh
./google-cloud-sdk/bin/gcloud init
</code></pre></div></div>

<p><strong>For Debian / Ubuntu</strong></p>

<p>Follow the instruction below to install the Cloud SDK:</p>

<ol>
  <li>Add the Cloud SDK distribution URI as a package source:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"deb [signed-by=/usr/share/keyrings/cloud.google.gpg] https://packages.cloud.google.com/apt cloud-sdk main"</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/apt/sources.list.d/google-cloud-sdk.list

<span class="nb">sudo </span>apt-get <span class="nb">install </span>apt-transport-https ca-certificates

curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | <span class="nb">sudo </span>apt-key <span class="nt">--keyring</span> /usr/share/keyrings/cloud.google.gpg add -
</code></pre></div></div>

<ol>
  <li>Update and install the Cloud SDK:</li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt-get <span class="nb">install </span>google-cloud-sdk

gcloud init
</code></pre></div></div>

<hr />

<h2 id="the-gcloud-commands-cheat-sheet">The <code class="highlighter-rouge">gcloud</code> Commands Cheat Sheet</h2>

<h3 id="find-the-project-id">Find the Project ID</h3>

<p>The most frequently <code class="highlighter-rouge">gcloud</code> command I used in Google Cloud Shells is to set the project ID as an environment variable with the Linux export command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">PROJECT_ID</span><span class="o">=</span><span class="si">$(</span>gcloud info <span class="nt">--format</span><span class="o">=</span><span class="s1">'value(config.project)'</span><span class="si">)</span>

<span class="nb">echo</span> <span class="nv">$PROJECT_ID</span>
</code></pre></div></div>

<p>There are so many situations that use the project ID as a parameter. This keeps your codes much tiny and secure by using the environment variable.</p>

<p>For example, the project ID is often used as the namespace of the bucket names in Google Cloud Storage:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">BUCKET</span><span class="o">=</span><span class="k">${</span><span class="nv">PROJECT_ID</span><span class="k">}</span>

gsutil mb gs://<span class="k">${</span><span class="nv">BUCKET</span><span class="k">}</span>
</code></pre></div></div>

<p>Every bucket name must be unique across the entire Google Cloud Storage. Using the project ID as prefix or suffix is a good practice for uniqueness and consistency of the bucket names.</p>

<h3 id="extract-a-value-from-a-json-output-of-a-gcloud-command">Extract a value from a JSON output of a <strong>gcloud</strong> command</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud compute ... <span class="nt">--format</span><span class="o">=</span>json | jq <span class="nt">-r</span> <span class="s1">'&lt;key&gt;'</span><span class="o">)</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">jq</code> is a lightweight and flexible command-line JSON processor. With the <code class="highlighter-rouge">-r</code> option, it outputs raw strings, not JSON texts. Use <code class="highlighter-rouge">jq --help</code> to show the help, or visit <a href="https://stedolan.github.io/jq/">its official site</a> for more details.</p>

<h3 id="find-the-service-account-for-compute-engine-api">Find the Service Account for Compute Engine API</h3>

<p>Besides the project ID, a service account email is required for several command-line tools, like creating a VM instance to GCE. You can extract the service account for the Compute Engine API using the following code:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">SERVICE_ACCOUNT</span><span class="o">=</span><span class="si">$(</span>gcloud <span class="nt">--project</span><span class="o">=</span><span class="nv">$PROJECT_ID</span> <span class="se">\</span>
    iam service-accounts list <span class="nt">--format</span><span class="o">=</span>json | jq <span class="nt">-r</span> <span class="s1">'.[] | select \
    (.displayName=="Compute Engine default service account").email'</span><span class="si">)</span>

<span class="nb">echo</span> <span class="nv">$SERVICE_ACCOUNT</span>
</code></pre></div></div>

<h3 id="find-the-used-ip-address">Find the used IP address</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">export </span><span class="nv">USED_IP_ADDRESS</span><span class="o">=</span><span class="si">$(</span>gcloud compute addresses describe <span class="nv">$USED_IP</span> <span class="se">\</span>
    <span class="nt">--region</span><span class="o">=</span>us-central1 <span class="nt">--format</span><span class="o">=</span>json | jq <span class="nt">-r</span> <span class="s1">'.address'</span><span class="si">)</span>

<span class="nb">echo</span> <span class="nv">$USED_IP_ADDRESS</span>
</code></pre></div></div>

<h3 id="change-default-zone">Change default zone</h3>

<p>To set a default zone to use when working with zonal Compute Engine resources, such as us-west1-b, run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud config <span class="nb">set </span>compute/zone us-west1-b
</code></pre></div></div>

<p>To list all zones in a project in table form, run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud compute zones list
</code></pre></div></div>

<p>For more details, please read https://cloud.google.com/sdk/gcloud/reference/compute/zones/list .</p>

<h3 id="shh-into-a-compute-engine-server">SHH into a Compute Engine server</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud compute ssh user@your-server-name-1-vm
</code></pre></div></div>

<p><em>Replace <code class="highlighter-rouge">user</code> and <code class="highlighter-rouge">your-server-name-1-vm</code> with yours.</em></p>

<h3 id="download-a-folder-from-the-server-through-scp">Download a folder from the server through SCP</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud compute scp <span class="nt">--recurse</span> user@your-server-name-1-vm:/path/to/the/directory/that/you/want/to/download/to/your/local/machine/ ./
</code></pre></div></div>

<p><em>Replace <code class="highlighter-rouge">user</code>, <code class="highlighter-rouge">your-server-name-1-vm</code> and <code class="highlighter-rouge">/path/to/the/directory/that/you/want/to/download/to/your/local/machine/</code> with yours.</em></p>

<h3 id="create-a-new-kubernetes-cluster">Create a new Kubernetes Cluster</h3>

<p>The following command is an example to create a new Kubernetes cluster named <code class="highlighter-rouge">my-cluster</code> with <em>two</em> nodes (<em>N1 standard 1</em>) in the zone <strong>us-central1-f</strong>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gcloud container clusters create my-cluster <span class="se">\</span>
<span class="nt">--num-nodes</span> 2 <span class="se">\</span>
<span class="nt">--machine-type</span> n1-standard-1 <span class="se">\</span>
<span class="nt">--zone</span> us-central1-f
</code></pre></div></div>

<p>You will receive warnings in the output that can be safely ignored. For more details, please read https://cloud.google.com/sdk/gcloud/reference/container/clusters/create .</p>

<hr />

<h2 id="the-gsutil-cheat-sheet">The <code class="highlighter-rouge">gsutil</code> Cheat Sheet</h2>

<p><strong>gsutil</strong> is the command-line Google Storage utilities. Equivalent to <code class="highlighter-rouge">aws s3</code> but for the Google Cloud Platform, it allows you to access Google Cloud Storage from the command line.</p>

<h3 id="create-a-multi-regional-bucket">Create a multi-regional bucket</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gsutil mb <span class="nt">-c</span> multi_regional gs://<span class="k">${</span><span class="nv">BUCKET</span><span class="k">}</span>
</code></pre></div></div>

<h3 id="copy-local-filesdirectory-into-a-gcs-bucket">Copy local file(s)/directory into a GCS bucket</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gsutil <span class="nb">cp</span> &lt;filename&gt; gs://<span class="k">${</span><span class="nv">BUCKET</span><span class="k">}</span>
</code></pre></div></div>

<h3 id="list-all-your-buckets">List all your buckets</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gsutil <span class="nb">ls</span>
</code></pre></div></div>

<p>For more about <strong>gsulit</strong>, please read https://cloud.google.com/storage/docs/gsutil or run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gsutil <span class="nb">help</span>
</code></pre></div></div>

<hr />

<h2 id="terraform-commands-cheat-sheet">Terraform Commands Cheat Sheet</h2>

<h3 id="switch-the-version-of-terraform-with-tfswitch">Switch the version of Terraform with tfswitch</h3>

<p>Confirm your Terraform version by using:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>terraform version
</code></pre></div></div>

<p>Your output should look like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Terraform v0.12.x
</code></pre></div></div>

<p>To switch to the desired version by using a Terraform version manager <strong>tfswitch</strong>, run the following codes to install and configure <code class="highlighter-rouge">tfswitch</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget https://github.com/warrensbox/terraform-switcher/releases/download/0.7.737/terraform-switcher_0.7.737_linux_amd64.tar.gz
<span class="nb">mkdir</span> <span class="nt">-p</span> <span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/bin
<span class="nb">tar</span> <span class="nt">-xvf</span> terraform-switcher_0.7.737_linux_amd64.tar.gz <span class="nt">-C</span> <span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/bin
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/bin
tfswitch <span class="nt">-b</span> <span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/bin/terraform 0.11.14
<span class="nb">echo</span> <span class="s2">"0.11.14"</span> <span class="o">&gt;&gt;</span> .tfswitchrc
<span class="nb">exit</span>
</code></pre></div></div>

<h3 id="run-terraform">Run Terraform</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>terraform init
</code></pre></div></div>

<p>The <strong>terraform init</strong> command is used to initialize a working directory containing the Terraform configuration files. This command performs several different initialization steps in order to prepare a working directory for use and is always safe to run multiple times, to bring the working directory up to date with changes in the configuration:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>terraform plan <span class="nt">-out</span><span class="o">=</span>tfplan
</code></pre></div></div>

<p>The <strong>terraform plan</strong> command is used to create an execution plan. Terraform performs a refresh, unless explicitly disabled, and then determines what actions are necessary to achieve the desired state specified in the configuration files. This command is a convenient way to check whether the execution plan for a set of changes matches your expectations without making any changes to real resources or to the state. For example, terraform plan might be run before committing a change to version control, to create confidence that it will behave as expected.</p>

<p>The optional <strong>-out</strong> argument can be used to save the generated plan to a file for later execution with terraform apply.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>terraform apply tfplan
</code></pre></div></div>

<p>The <strong>terraform apply</strong> command is used to apply the changes required to reach the desired state of the configuration, or the pre-determined set of actions generated by a terraform plan execution plan.</p>

<hr />

<h2 id="other-useful-linux-commands">Other useful Linux Commands</h2>

<h3 id="create-a-text-file-with-content">Create a text file with content</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> <span class="o">&gt;</span> &lt;your-filename&gt; <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">
/*
text contents
*/
</span><span class="no">EOF
</span></code></pre></div></div>

<p><em>Replace <code class="highlighter-rouge">&lt;your-filename&gt;</code> and <code class="highlighter-rouge">/*text contents*/</code> with yours.</em></p>

<hr />

<p><strong>Related:</strong> <a href="/blog/qwiklabs/Qwiklabs-User-Tips-for-Learning_Google_Cloud_Platform">Learning Google Cloud Platform on Qwiklabs: Learning Map, Assistive Tool and Tips</a></p>

<blockquote>
  <p>This list will be kept updated. If you need more, please leave me your feedback, questions, comments, suggestions below.</p>
</blockquote>

</div>

<!-- Post info -->
<div class="noteinfo">
<!-- include some categories and tags maybe? -->
</div>

<hr>

<!-- Post comments -->


<!-- Disqus comments -->
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = "https://chriskyfung.github.io//blog/qwiklabs/Useful-Google-Cloud-Platform-Commands-Cheat-Sheet";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = "https://chriskyfung.github.io//blog/qwiklabs/Useful-Google-Cloud-Platform-Commands-Cheat-Sheet"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://chriskyfung.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


	</section>
	<aside id="sidebar">
  
  
  
  <h2><i class='far fa-newspaper'></i> <a href="/blog/index.html">Blog</a></h2>
  <h3><a href="/blog/categories.html">Categories</a></h3>
  <h3><a href="/blog/tags.html">Tags</a></h3>
  <ul>    
    <li><h3><a href="/tag/Qwiklabs">Qwiklabs Tools & Logbooks</a></h3></li>
    <li><h3><a href="/tag/Tumblr">For Tumblr Developer</a></h3></li>
    <li><h3><a href="/tag/MATLAB">MATLAB Tips</a></h3></li>
  </ul>
  <h2><i class='fab fa-youtube'></i> <a href="https://www.youtube.com/channel/UCp0xYv7zaQmAj77GcU-msJg">YouTube Channels</a></h2>
  <ul><li><h3><a href="https://www.youtube.com/channel/UCp0xYv7zaQmAj77GcU-msJg" target="_blank">Chris's Research Channel</a></h3></li>
    <li><h3><a href='https://www.youtube.com/channel/UCGlT2itihZuRxMckNcfcA3A'>Craftweeks Channel</a></h3></li>
  </ul>
  
  <h2>&nbsp;<a href="https://www.paypal.me/chrisfungky/50" target="_blank"><button class="round">Give me a help <i class='fas fa-donate'></i></button></a></h2>
  
  <h2><i class='fas fa-gift'></i> <a href="https://invitation.codes/u/qgcUCyqa" target="_blank">Promo Codes</a></h2>
  
  <!-- Copyscape Banner -->
  <div id="copyscape-banner"><a href="http://www.copyscape.com/"><img src="//banners.copyscape.com/img/copyscape-banner-white-130x46.png" width="130" height="46" border="0" alt="Protected by Copyscape" title="Protected by Copyscape - Do not copy content from this page." /></a></div>

  <!-- Google Adsense -->  
  <script data-ad-client="ca-pub-4819282024314540" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- github_resp_sidebar -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-4819282024314540"
     data-ad-slot="1391498756"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
  
  <!-- Affiliate Disclouse -->
  <div id="vig-disclose"><a href="https://www.viglink.com/legal/disclosures/users?vgtag=badge"><img alt="VigLink badge" height="60" src="https://www.viglink.com/images/badges/120x60.png" title="Links monetized by VigLink" width="120"/></a></div>
</aside>

	</div>
    </div>  

    <footer>   
    <div class="invitation-codes invitation-codes-badge1" data-type="badge1" data-product="" style="float:left;"><a class="" href="https://invitation.codes/" data-type="badge1">Use my referral codes</a></div>
<script async defer src="//invitation.codes/embed/user/qgcUCyqa/embed.js"></script>

    <div id="footer-copyright">&copy; 2014-2020 Chris KY FUNG. All rights reserved</div>
    <div id="footer-powered">Powered by <a href="https://pages.github.com">GitHub Pages</a></div>
</footer>

	
    
      <!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=UA-72575541-9"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());

	  gtag('config', 'UA-72575541-9');
	</script>
    
    
    <!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5d01c83d522ad580"></script>
    <script type="text/javascript">
  var vglnk = {key: '56a8cde8bc46ec169ed23320c0e35c68'};
  (function(d, t) {
      var s = d.createElement(t);
          s.type = 'text/javascript';
          s.async = true;
          s.src = '//cdn.viglink.com/api/vglnk.js';
      var r = d.getElementsByTagName(t)[0];
          r.parentNode.insertBefore(s, r);
  }(document, 'script'));
</script>
	  
  </body>
</html>

