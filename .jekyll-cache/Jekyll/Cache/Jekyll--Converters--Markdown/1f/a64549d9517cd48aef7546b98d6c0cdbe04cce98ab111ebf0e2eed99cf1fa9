I"Š<!--more-->

<p><img src="/images/posts/matlab/convert-matrix-between-matlab-and-ms-equation.jpg" alt="MATLAB TIPS - Convert MatrixÂ betweenÂ MATLABÂ andÂ MSÂ Equation" /></p>

<p>When I was studying my MPhil and PhD degrees, one bothering job was to rewrite the programmed formulas and computational results that were coded with numerical analysis software, MATLAB to my papers and my theses. At that time, I used Microsoft Word as my primary word processing software. Manually typing and formatting the data (in the MS Equation Editor) consume time and easily generate human mistakes. Thus, I developed a couple of functions to convert matrix data between MATLAB and MS Office Equation formats. The MATLAB codes are available in my GitHub repository.</p>

<p><strong>Download</strong> [ <a href="https://github.com/chriskyfung/matlab-matrix-to-ms-office-equation">GitHub</a> ]</p>

<p>The usages are described below.</p>

<h2 id="convert-from-matlab-to-ms-office-equation">Convert from MATLAB to MS Office Equation</h2>

<p>The file <code class="highlighter-rouge">mat2mseq.m</code> contains the function to convert a numerical matrix in MATLAB to a plain-text formatted MS office equation. The function takes two arguments:</p>

<ul>
  <li>&lt;m-by-n matrix&gt; A two-dimensional matrix of numbers</li>
  <li>&lt;string&gt; The string format of the numbers (see <a href="https://www.mathworks.com/help/matlab/ref/sprintf.html">sprintf</a>)</li>
</ul>

<p><strong>Example</strong></p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="n">martixA</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">];</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">mat2mseq</span><span class="p">(</span><span class="n">martixA</span><span class="p">,</span> <span class="s1">'%g'</span><span class="p">);</span>

<span class="o">=&gt;</span> <span class="n">s</span> <span class="o">=</span>
     <span class="err">â– </span><span class="p">(</span><span class="mi">1</span><span class="o">&amp;</span><span class="mi">0</span><span class="o">&amp;</span><span class="mi">0</span><span class="o">@</span><span class="mi">0</span><span class="o">&amp;</span><span class="mi">1</span><span class="o">&amp;</span><span class="mi">0</span><span class="o">@</span><span class="mi">0</span><span class="o">&amp;</span><span class="mi">0</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>Copy the text output to an equation object in Microsoft Word, OneNote or PowerPoint.</p>

<p>You will obtain <img src="/images/posts/matlab/matrixA.png" alt="matrixA" /> in the MS Equation Editor.</p>

<h2 id="convert-from-ms-office-equation-to-matlab">Convert from MS Office Equation to MATLAB</h2>

<p>The file <code class="highlighter-rouge">mseq2mat.m</code> contains the function to convert an MS Equation matrix to numerical data in MATLAB. The function requires the following argument:</p>
<ul>
  <li>&lt;string&gt; a matrix in the MS office equation (in plain-text format)</li>
</ul>

<p>For example, when you copy <img src="/images/posts/matlab/matrixA.png" alt="matrixA" /> from MS Word and paste it to MATLAB. The matrix will be displayed in the plain-text format of MS Equation, like <code class="highlighter-rouge">â– (1&amp;0&amp;0@0&amp;1&amp;0@0&amp;0&amp;1)</code> in the command line. Convert it to numerical data by evaluating the text with the function, as the example below:</p>

<div class="language-matlab highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span> <span class="o">=</span> <span class="n">mseq2mat</span><span class="p">(</span><span class="s1">'â– (1&amp;0&amp;0@0&amp;1&amp;0@0&amp;0&amp;1)'</span><span class="p">)</span>
	
<span class="o">=&gt;</span> <span class="n">A</span> <span class="o">=</span> 
	<span class="p">[</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="p">;</span> 
	  <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="p">;</span> 
	  <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="p">]</span> 
</code></pre></div></div>

<h2 id="for-developers">For Developers</h2>
<p>To develop your MATH translator, you can read the documentation <em>â€œ<a href="https://www.unicode.org/notes/tn28/">UTN #28: Nearly Plain-Text Encoding of Mathematics</a>â€œ</em> to explore how Microsoft uses Unicodes in encoding mathematical expressions. If you want to learn about the shortcut commands of MS Equation Editor, this <a href="http://www.iun.edu/~mathiho/useful/Equation%20Editor%20Shortcut%20Commands.pdf">PDF Note</a> from <em>Indiana University Northwest</em> should be helpful.</p>

<p>Do you use any great tools when writing your reports and essays? Have a question or suggestion? Let us know in the comments below.</p>

<hr />

<p><strong>Related posts:</strong></p>

<ul>
  <li><a href="/blog/matlab/Working-MATLAB-with-MS-Excel">Working MATLAB with MS Excel</a></li>
  <li><a href="/blog/matlab/expand-twitter-short-url">Expand shorten URLs in MATLAB</a></li>
</ul>
:ET